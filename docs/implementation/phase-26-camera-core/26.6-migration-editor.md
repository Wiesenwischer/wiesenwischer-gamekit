# 26.6 Migration & Editor Update

> **Commit:** `feat(phase-26): 26.6 Migration & Editor Update`

---

## Ziel

1. Bestehende `ThirdPersonCamera` + `CameraInputHandler` als `[Obsolete]` markieren
2. `CameraSetupEditor` in das neue Camera.Core Package migrieren
3. Editor-Menü aktualisieren, damit es die neuen Komponenten erstellt

**Hinweis:** Die alten Komponenten werden noch NICHT gelöscht. Sie werden als `[Obsolete]` markiert, damit bestehende Szenen weiterhin funktionieren. Endgültige Löschung erfolgt nach Phase 27, wenn alle Behaviours extrahiert sind.

---

## 1. Alte Komponenten als Obsolete markieren

**`ThirdPersonCamera.cs`** — Header ergänzen:
```csharp
[Obsolete("Verwende CameraBrain + PivotRig + CameraAnchor statt ThirdPersonCamera. Wird nach Phase 27 entfernt.")]
public class ThirdPersonCamera : MonoBehaviour { ... }
```

**`CameraInputHandler.cs`** — Header ergänzen:
```csharp
[Obsolete("Verwende CameraInputPipeline statt CameraInputHandler. Wird nach Phase 27 entfernt.")]
public class CameraInputHandler : MonoBehaviour { ... }
```

---

## 2. CameraSetupEditor migrieren

**Neuer Ort:** `Packages/Wiesenwischer.GameKit.Camera.Core/Editor/CameraSetupEditor.cs`

**Editor .asmdef:**
```json
{
  "name": "Wiesenwischer.GameKit.Camera.Core.Editor",
  "rootNamespace": "Wiesenwischer.GameKit.Camera.Editor",
  "references": [
    "Wiesenwischer.GameKit.Camera.Core.Runtime",
    "Unity.InputSystem"
  ],
  "includePlatforms": ["Editor"],
  "excludePlatforms": []
}
```

### Neues Setup-Menü

**MenuItem:** `Wiesenwischer/GameKit/Camera/Setup Camera Brain`

Was das Setup macht:
1. Findet oder erstellt Main Camera GameObject
2. Fügt `PivotRig` hinzu → ruft `EnsureHierarchy()` auf
3. Fügt `CameraBrain` hinzu
4. Erstellt separates `CameraAnchor` GameObject (am Character Root)
5. Fügt `CameraInputPipeline` hinzu (am Camera Root)
6. Sucht und verknüpft `InputActionAsset`
7. Erstellt oder findet `CameraConfig` ScriptableObject
8. Sucht Player-GameObject als Follow Target
9. Ruft `SnapBehindTarget()` auf

### Menü-Struktur

```
Wiesenwischer/GameKit/Camera/
    ├── Setup Camera Brain        ← NEU
    └── Setup Third Person Camera ← [Obsolete] Marker im Label
```

---

## 3. Package-Abhängigkeit

Das alte `CharacterController.Camera` Package bleibt bestehen, hat aber keine Abhängigkeit zum neuen `Camera.Core`. Die Pakete sind unabhängig:

```
Camera.Core (neu)
    ├── CameraBrain
    ├── PivotRig
    ├── CameraAnchor
    └── CameraInputPipeline

CharacterController.Camera (alt, deprecated)
    ├── ThirdPersonCamera [Obsolete]
    ├── CameraInputHandler [Obsolete]
    └── CameraConfig (weiterhin gültig, wird von Camera.Core referenziert)
```

**CameraConfig bleibt im alten Package**, da es stabil ist und keine Änderungen braucht. Camera.Core referenziert es über Assembly-Referenz. Alternativ kann CameraConfig in Phase 27 migriert werden.

**Assembly-Referenz hinzufügen:**
`Camera.Core.Runtime.asmdef` → Reference zu `Wiesenwischer.GameKit.CharacterController.Camera.Runtime` (für CameraConfig).

---

## 4. Szenen-Migration

Bestehende Szenen mit ThirdPersonCamera:
1. User führt `Wiesenwischer/GameKit/Camera/Setup Camera Brain` aus
2. Alte ThirdPersonCamera + CameraInputHandler können manuell entfernt werden
3. Kamera funktioniert sofort mit neuen Komponenten

---

## Akzeptanzkriterien

- [ ] ThirdPersonCamera und CameraInputHandler sind als `[Obsolete]` markiert
- [ ] Neues Editor-Menü erstellt CameraBrain + PivotRig + CameraAnchor + CameraInputPipeline
- [ ] Setup findet Player als Follow Target
- [ ] Setup verknüpft InputActionAsset
- [ ] Kamera ist nach Setup voll funktionsfähig
- [ ] Alte Szenen kompilieren weiterhin (keine Breaking Changes)
