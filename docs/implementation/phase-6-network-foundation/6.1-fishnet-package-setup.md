# 6.1 FishNet Installation & Network Package

**Commit:** `feat(phase-6): 6.1 FishNet Installation & Network Package`
**Branch:** `feat/network-package-setup`

---

## Ziel

FishNet als Netzwerk-Framework und ParrelSync als Multiplayer-Test-Tool ins Projekt integrieren. Dazu das neue `Wiesenwischer.GameKit.Network.FishNet`-Package anlegen.

---

## Anweisungen

### 1. FishNet importieren

FishNet wird als **Asset** importiert (nicht als UPM-Package, da FishNet kein offizielles UPM-Format nutzt).

**Option A: Unity Asset Store (empfohlen)**
1. Unity Editor → Window → Package Manager → My Assets
2. "Fish-Networking" suchen und importieren
3. Ziel: `Assets/FishNet/` Ordner entsteht

**Option B: GitHub**
1. https://github.com/FirstGearGames/FishNet herunterladen
2. `FishNet/` Ordner nach `Assets/FishNet/` kopieren

**Wichtig:**
- FishNet lebt unter `Assets/`, NICHT unter `Packages/` (Asset Store Convention)
- Die FishNet-Assembly heißt `FishNet.Runtime` (Referenz für asmdef)
- Version 4.x (LTS) für Unity 2022.3

### 2. ParrelSync installieren

**ParrelSync** erstellt einen symbolisch verlinkten Klon des Unity-Projekts, sodass zwei Editor-Instanzen gleichzeitig laufen können — ohne Build, ohne extra Speicherplatz.

**Installation via UPM (Git URL):**
1. Unity Editor → Window → Package Manager → "+" → "Add package from git URL..."
2. URL eingeben: `https://github.com/VeriorPies/ParRelSync.git?path=/ParrelSync`
3. Installieren

**Alternativ via manifest.json:**
```json
// Packages/manifest.json → "dependencies" ergänzen:
"com.veriorpies.parrelsync": "https://github.com/VeriorPies/ParRelSync.git?path=/ParrelSync"
```

**Nach Installation:**
1. Unity Editor → ParrelSync → Clones Manager
2. "Create new clone" klicken → Klon wird erstellt (Symlinks, dauert ~30s)
3. "Open in New Editor" → Zweite Unity-Instanz öffnet sich

**Test-Workflow:**
- Editor 1 (Original): Play → "Start Host"
- Editor 2 (Klon): Play → "Start Client"
- Beide Editoren zeigen das gleiche Projekt, Code-Änderungen sind sofort in beiden sichtbar

**Wichtig:**
- ParrelSync ist ein **reines Entwicklungstool** — wird nicht mit dem Spiel ausgeliefert
- Der Klon teilt alle Assets/Packages über Symlinks (kein doppelter Speicherverbrauch)
- Bei Git: Der Klon-Ordner wird automatisch in `.gitignore` eingetragen

### 3. Transport Layer

FishNet braucht einen Transport-Layer. **Tugboat** (UDP, eingebaut in FishNet) reicht für die Entwicklung:
- Keine zusätzliche Installation nötig
- Automatisch verfügbar nach FishNet-Import

### 4. Network Package erstellen

Neues Package: `Packages/Wiesenwischer.GameKit.Network.FishNet/`

**Ordnerstruktur:**
```
Packages/Wiesenwischer.GameKit.Network.FishNet/
├── package.json
├── Runtime/
│   ├── Wiesenwischer.GameKit.Network.FishNet.Runtime.asmdef
│   └── Core/
│       └── (Platzhalter für spätere Klassen)
├── Editor/
│   └── Wiesenwischer.GameKit.Network.FishNet.Editor.asmdef
└── Tests/
    └── Runtime/
        └── Wiesenwischer.GameKit.Network.FishNet.Tests.Runtime.asmdef
```

### 5. package.json

```json
{
  "name": "wiesenwischer.gamekit.network.fishnet",
  "displayName": "GameKit Network - FishNet",
  "version": "0.1.0",
  "unity": "2022.3",
  "description": "FishNet-basierte Netzwerk-Integration für den GameKit Character Controller. Client-Side Prediction, Input Sync, State Reconciliation.",
  "keywords": [
    "network",
    "multiplayer",
    "fishnet",
    "prediction",
    "mmo",
    "sync"
  ],
  "author": {
    "name": "Wiesenwischer",
    "url": "https://github.com/Wiesenwischer"
  },
  "dependencies": {
    "wiesenwischer.gamekit.charactercontroller.core": "0.1.0"
  }
}
```

**Hinweis:** FishNet ist KEINE package.json-Dependency (lebt unter Assets/). Die Verbindung läuft über asmdef-Referenzen.

### 6. Runtime asmdef

```json
{
    "name": "Wiesenwischer.GameKit.Network.FishNet.Runtime",
    "rootNamespace": "Wiesenwischer.GameKit.Network",
    "references": [
        "Wiesenwischer.GameKit.CharacterController.Core.Runtime",
        "FishNet.Runtime"
    ],
    "includePlatforms": [],
    "excludePlatforms": [],
    "allowUnsafeCode": false,
    "overrideReferences": false,
    "precompiledReferences": [],
    "autoReferenced": true,
    "defineConstraints": [],
    "versionDefines": [],
    "noEngineReferences": false
}
```

### 7. Editor asmdef

```json
{
    "name": "Wiesenwischer.GameKit.Network.FishNet.Editor",
    "rootNamespace": "Wiesenwischer.GameKit.Network.Editor",
    "references": [
        "Wiesenwischer.GameKit.Network.FishNet.Runtime",
        "Wiesenwischer.GameKit.CharacterController.Core.Runtime",
        "FishNet.Runtime"
    ],
    "includePlatforms": ["Editor"],
    "excludePlatforms": [],
    "allowUnsafeCode": false,
    "overrideReferences": false,
    "precompiledReferences": [],
    "autoReferenced": true,
    "defineConstraints": [],
    "versionDefines": [],
    "noEngineReferences": false
}
```

### 8. Tests asmdef

```json
{
    "name": "Wiesenwischer.GameKit.Network.FishNet.Tests.Runtime",
    "rootNamespace": "Wiesenwischer.GameKit.Network.Tests",
    "references": [
        "UnityEngine.TestRunner",
        "UnityEditor.TestRunner",
        "Wiesenwischer.GameKit.Network.FishNet.Runtime",
        "Wiesenwischer.GameKit.CharacterController.Core.Runtime",
        "FishNet.Runtime"
    ],
    "includePlatforms": [],
    "excludePlatforms": [],
    "allowUnsafeCode": false,
    "overrideReferences": true,
    "precompiledReferences": ["nunit.framework.dll"],
    "autoReferenced": false,
    "defineConstraints": ["UNITY_INCLUDE_TESTS"],
    "versionDefines": [],
    "noEngineReferences": false
}
```

---

## Verifikation

- [ ] FishNet unter `Assets/FishNet/` vorhanden
- [ ] ParrelSync installiert (Menü: ParrelSync → Clones Manager sichtbar)
- [ ] ParrelSync-Klon erstellt und zweiter Editor lässt sich öffnen
- [ ] Package `Wiesenwischer.GameKit.Network.FishNet` kompiliert ohne Fehler
- [ ] asmdef-Referenzen auf `FishNet.Runtime` und `CharacterController.Core.Runtime` aufgelöst
- [ ] `CharacterController.Core` hat **keine** Referenz auf FishNet (Dependency Inversion)

---

## Erwartete Dateien

```
Assets/FishNet/                    (FishNet Asset — nicht im Package)
Packages/Wiesenwischer.GameKit.Network.FishNet/
├── package.json
├── Runtime/
│   ├── Wiesenwischer.GameKit.Network.FishNet.Runtime.asmdef
│   └── Core/
├── Editor/
│   └── Wiesenwischer.GameKit.Network.FishNet.Editor.asmdef
└── Tests/Runtime/
    └── Wiesenwischer.GameKit.Network.FishNet.Tests.Runtime.asmdef
```

---

→ Nächster Schritt: [6.2 Network Abstractions in Core](6.2-network-abstractions.md)
