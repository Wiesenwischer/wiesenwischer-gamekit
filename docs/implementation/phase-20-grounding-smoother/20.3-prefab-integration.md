# 20.3 Prefab-Integration

> **Branch:** `feat/grounding-smoother-integration`
> **Commit:** `feat(phase-20): 20.3 Prefab-Integration`

---

## Ziel

GroundingSmoother-Komponente zum Player Prefab hinzufügen und korrekt konfigurieren.

---

## Dateien

| Aktion | Pfab |
|--------|------|
| Bearbeiten | `Assets/Prefabs/Player.prefab` |

---

## Prefab-Hierarchie (Vorher → Nachher)

```
Player (Root)                          Player (Root)
├── CharacterMotor                     ├── CharacterMotor
├── PlayerController                   ├── PlayerController
├── CharacterLocomotion                ├── CharacterLocomotion
└── CharacterModel (Child)        →    ├── GroundingSmoother              ← NEU
    ├── Animator                       │   └── _modelTransform → CharacterModel
    └── AnimatorParameterBridge        └── CharacterModel (Child)
                                           ├── Animator
                                           └── AnimatorParameterBridge
```

---

## Detaillierte Anweisungen

### 1. Prefab öffnen

1. Unity Editor öffnen
2. `Assets/Prefabs/Player.prefab` doppelklicken (Prefab Mode)

### 2. GroundingSmoother hinzufügen

1. **Player (Root)** GameObject auswählen
2. Add Component → `GroundingSmoother`
3. Felder konfigurieren:

| Feld | Wert | Erklärung |
|------|------|-----------|
| `Model Transform` | CharacterModel (Child) | Per Drag & Drop aus Hierarchy |
| `Smooth Time` | 0.075 | Balanced — guter Kompromiss |
| `Max Step Delta` | 0.5 | Sollte ≥ LocomotionConfig.MaxStepHeight sein |
| `Only When Grounded` | ✅ true | Kein Smoothing in der Luft |

### 3. Prefab speichern

- Ctrl+S im Prefab Mode
- Prefab Mode verlassen

---

## Hinweise

- **Keine Änderung** an bestehenden Komponenten nötig
- Der Smoother liest nur Motor-Position und Grounding-Status
- Er schreibt nur `localPosition.y` auf das CharacterModel
- Falls `BasicPlayer.prefab` existiert: dort ebenfalls hinzufügen

---

## Verifikation

- [ ] GroundingSmoother auf Player Root hinzugefügt
- [ ] `_modelTransform` zeigt auf CharacterModel Child
- [ ] `_smoothTime` = 0.075
- [ ] `_maxStepDelta` = 0.5
- [ ] `_onlyWhenGrounded` = true
- [ ] Prefab gespeichert
- [ ] Keine Compiler-Fehler nach Prefab-Änderung

---

## Nächster Schritt

→ [20.4 Verifikation](20.4-verification.md)
