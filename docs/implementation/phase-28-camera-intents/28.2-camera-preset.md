# 28.2 CameraPreset ScriptableObject + Package

> **Commit:** `feat(phase-28): 28.2 CameraPreset ScriptableObject + Preset-Package`
> **Branch:** `feat/camera-presets` (vom Integration-Branch)

---

## Ziel

Ein **CameraPreset ScriptableObject** erstellen, das alle Behaviour-Parameter als konfigurierbare Felder enthält. Designer können Camera-Styles komplett per Asset definieren. Zusätzlich das **Camera.Presets Package** als Content-Package für vordefinierte Presets anlegen.

---

## Neue Dateien

### 1. CameraPreset.cs

**Pfad:** `Packages/Wiesenwischer.GameKit.Camera.Core/Runtime/Core/CameraPreset.cs`

Das CameraPreset lebt in Camera.Core (nicht im Presets-Package), damit Behaviours in Camera.Behaviours es referenzieren können ohne zirkuläre Abhängigkeit.

```csharp
using UnityEngine;

namespace Wiesenwischer.GameKit.Camera
{
    /// <summary>
    /// Definiert einen kompletten Camera-Style als konfigurierbares Asset.
    /// Enthält Parameter für alle Standard-Behaviours.
    /// CameraBrain.SetPreset() wendet die Werte auf die aktiven Behaviours an.
    /// </summary>
    [CreateAssetMenu(
        fileName = "CameraPreset",
        menuName = "Wiesenwischer/GameKit/Camera Preset",
        order = 1)]
    public class CameraPreset : ScriptableObject
    {
        [Header("General")]
        [Tooltip("Beschreibung des Preset-Stils")]
        public string Description;

        [Tooltip("Standard Field of View")]
        [Range(40f, 100f)]
        public float DefaultFov = 60f;

        [Header("Orbit")]
        [Tooltip("Minimaler Pitch-Winkel (nach unten)")]
        [Range(-89f, 0f)]
        public float PitchMin = -40f;

        [Tooltip("Maximaler Pitch-Winkel (nach oben)")]
        [Range(0f, 89f)]
        public float PitchMax = 70f;

        [Header("Zoom")]
        [Tooltip("Standard-Abstand zum Target")]
        [Range(1f, 20f)]
        public float DefaultDistance = 5f;

        [Tooltip("Minimaler Abstand")]
        [Range(0.5f, 10f)]
        public float MinDistance = 2f;

        [Tooltip("Maximaler Abstand")]
        [Range(5f, 30f)]
        public float MaxDistance = 15f;

        [Tooltip("Zoom-Glättung (SmoothDamp-Zeit)")]
        [Range(0f, 1f)]
        public float ZoomDamping = 0.1f;

        [Header("Collision")]
        [Tooltip("Radius für SphereCast")]
        [Range(0.1f, 1f)]
        public float CollisionRadius = 0.3f;

        [Tooltip("Geschwindigkeit der Kamera-Rückkehr nach Collision")]
        [Range(0.5f, 20f)]
        public float CollisionRecoverySpeed = 5f;

        [Header("Inertia")]
        [Tooltip("Inertia aktiviert?")]
        public bool InertiaEnabled = true;

        [Tooltip("Steifigkeit (wie schnell die Kamera folgt)")]
        [Range(1f, 50f)]
        public float InertiaStiffness = 15f;

        [Tooltip("Dämpfung (reduziert Oszillation)")]
        [Range(0.5f, 0.99f)]
        public float InertiaDamping = 0.85f;

        [Tooltip("Maximaler Offset in Metern")]
        [Range(0.1f, 5f)]
        public float InertiaMaxOffset = 1.5f;

        [Header("Recenter")]
        [Tooltip("Auto-Recenter aktiviert?")]
        public bool RecenterEnabled = true;

        [Tooltip("Verzögerung in Sekunden bevor Recenter startet")]
        [Range(0f, 10f)]
        public float RecenterDelay = 2f;

        [Tooltip("Recenter-Geschwindigkeit in Grad/Sekunde")]
        [Range(10f, 360f)]
        public float RecenterSpeed = 90f;

        [Tooltip("Minimum Character-Geschwindigkeit für Recenter")]
        [Range(0f, 5f)]
        public float RecenterMinSpeed = 0.5f;

        [Header("Shoulder Offset")]
        [Tooltip("Shoulder Offset aktiviert?")]
        public bool ShoulderEnabled = false;

        [Tooltip("Seitlicher Versatz (positiv = rechts)")]
        [Range(-2f, 2f)]
        public float ShoulderOffsetX = 0.5f;

        [Tooltip("Vertikaler Versatz")]
        [Range(-1f, 1f)]
        public float ShoulderOffsetY = 0f;

        [Tooltip("Smooth-Zeit beim Seiten-Wechsel")]
        [Range(0f, 1f)]
        public float ShoulderSwitchDamping = 0.2f;

        [Header("Dynamic Orbit Center")]
        [Tooltip("Dynamic Orbit Center aktiviert?")]
        public bool DynamicOrbitEnabled = false;

        [Tooltip("Forward Bias bei Bewegung (wie weit vor dem Character)")]
        [Range(0f, 3f)]
        public float ForwardBias = 0.5f;

        [Tooltip("Smooth-Zeit für Orbit-Center-Verschiebung")]
        [Range(0f, 0.5f)]
        public float OrbitCenterDamping = 0.1f;

        [Header("Soft Targeting")]
        [Tooltip("Soft Targeting aktiviert?")]
        public bool SoftTargetingEnabled = false;

        [Tooltip("Stärke des Movement-Forward-Bias (Grad)")]
        [Range(0f, 30f)]
        public float MovementBiasStrength = 5f;

        [Tooltip("Stärke des Target-Bias (Grad)")]
        [Range(0f, 45f)]
        public float TargetBiasStrength = 15f;

        [Tooltip("Maximaler Radius für Soft Target Erfassung")]
        [Range(0f, 50f)]
        public float SoftTargetRange = 20f;

        [Tooltip("Smooth-Zeit für Bias-Übergänge")]
        [Range(0f, 1f)]
        public float SoftTargetDamping = 0.15f;
    }
}
```

### 2. ICameraPresetReceiver.cs

**Pfad:** `Packages/Wiesenwischer.GameKit.Camera.Core/Runtime/Core/ICameraPresetReceiver.cs`

```csharp
namespace Wiesenwischer.GameKit.Camera
{
    /// <summary>
    /// Optionales Interface für ICameraBehaviours die Preset-Werte empfangen können.
    /// CameraBrain.SetPreset() prüft jedes Behaviour auf dieses Interface.
    /// </summary>
    public interface ICameraPresetReceiver
    {
        /// <summary>
        /// Übernimmt die relevanten Werte aus dem Preset.
        /// Jedes Behaviour liest nur die für sich relevanten Felder.
        /// </summary>
        void ApplyPreset(CameraPreset preset);
    }
}
```

### 3. Camera.Presets Package

**Pfad:** `Packages/Wiesenwischer.GameKit.Camera.Presets/`

#### package.json

```json
{
    "name": "com.wiesenwischer.gamekit.camera.presets",
    "version": "0.1.0",
    "displayName": "Wiesenwischer GameKit - Camera Presets",
    "description": "Vordefinierte Camera-Style Presets (BDO, ArcheAge) für das Camera System.",
    "unity": "2022.3",
    "dependencies": {
        "com.wiesenwischer.gamekit.camera.core": "0.1.0"
    },
    "author": {
        "name": "Wiesenwischer"
    }
}
```

#### Assembly Definition

**Pfad:** `Packages/Wiesenwischer.GameKit.Camera.Presets/Runtime/Wiesenwischer.GameKit.Camera.Presets.Runtime.asmdef`

```json
{
    "name": "Wiesenwischer.GameKit.Camera.Presets.Runtime",
    "rootNamespace": "Wiesenwischer.GameKit.Camera.Presets",
    "references": [
        "Wiesenwischer.GameKit.Camera.Core.Runtime"
    ],
    "includePlatforms": [],
    "excludePlatforms": [],
    "allowUnsafeCode": false,
    "overrideReferences": false,
    "precompiledReferences": [],
    "autoReferenced": true,
    "defineConstraints": [],
    "versionDefines": [],
    "noEngineReferences": false
}
```

---

## Anweisungen

### Schritt 1: CameraPreset.cs erstellen

1. Erstelle `CameraPreset.cs` in `Camera.Core/Runtime/Core/`
2. Implementiere alle Felder wie oben beschrieben
3. Jedes Feld hat `[Tooltip]` und sinnvollen `[Range]`
4. Header-Gruppierung für Inspector-Übersicht

### Schritt 2: ICameraPresetReceiver.cs erstellen

1. Erstelle `ICameraPresetReceiver.cs` in `Camera.Core/Runtime/Core/`
2. Einfaches Interface mit einer Methode

### Schritt 3: Camera.Presets Package anlegen

1. Erstelle Package-Ordner `Packages/Wiesenwischer.GameKit.Camera.Presets/`
2. Erstelle `package.json` mit Abhängigkeit auf `Camera.Core`
3. Erstelle `Runtime/` mit Assembly Definition
4. Erstelle `Presets/` Ordner für die Asset-Dateien (werden in 28.3 befüllt)

### Schritt 4: Bestehende Behaviours um ICameraPresetReceiver erweitern

**Hinweis:** Dieser Schritt kann erst nach Phase 27 durchgeführt werden, wenn die Behaviours existieren.

Jedes Phase-27-Behaviour erhält `ICameraPresetReceiver`:

```csharp
// Beispiel: OrbitBehaviour (bereits aus Phase 27)
public class OrbitBehaviour : MonoBehaviour, ICameraBehaviour, ICameraPresetReceiver
{
    // ... bestehende Felder ...

    public void ApplyPreset(CameraPreset preset)
    {
        _pitchMin = preset.PitchMin;
        _pitchMax = preset.PitchMax;
    }
}
```

Analog für:
- **ZoomBehaviour** → liest `DefaultDistance`, `MinDistance`, `MaxDistance`, `ZoomDamping`
- **CollisionBehaviour** → liest `CollisionRadius`, `CollisionRecoverySpeed`
- **InertiaBehaviour** → liest `InertiaEnabled`, `InertiaStiffness`, `InertiaDamping`, `InertiaMaxOffset`
- **RecenterBehaviour** → liest `RecenterEnabled`, `RecenterDelay`, `RecenterSpeed`, `RecenterMinSpeed`
- **ShoulderOffsetBehaviour** → liest `ShoulderEnabled`, `ShoulderOffsetX`, `ShoulderOffsetY`, `ShoulderSwitchDamping`

---

## Verifikations-Checkliste

- [ ] `CameraPreset.cs` existiert in `Camera.Core/Runtime/Core/`
- [ ] CameraPreset ist als ScriptableObject im Asset-Menü erstellbar
- [ ] Alle Felder haben Tooltips und Range-Attribute
- [ ] `ICameraPresetReceiver.cs` existiert in `Camera.Core/Runtime/Core/`
- [ ] Camera.Presets Package existiert mit korrekter `package.json`
- [ ] Assembly Definition verweist korrekt auf Camera.Core
- [ ] Projekt kompiliert fehlerfrei
- [ ] Im Unity-Editor: `Create → Wiesenwischer → GameKit → Camera Preset` funktioniert

---

## Erwartete Dateien nach diesem Schritt

```
Packages/Wiesenwischer.GameKit.Camera.Core/Runtime/Core/
├── CameraPreset.cs           (NEU)
├── ICameraPresetReceiver.cs  (NEU)
├── ICameraIntent.cs          (aus 28.1)
├── ICameraBehaviour.cs       (unverändert)
├── CameraState.cs            (unverändert)
├── CameraInputState.cs       (unverändert)
├── CameraContext.cs           (aus 28.1 erweitert)
└── CameraCoreConfig.cs       (unverändert)

Packages/Wiesenwischer.GameKit.Camera.Presets/
├── package.json               (NEU)
├── Runtime/
│   └── Wiesenwischer.GameKit.Camera.Presets.Runtime.asmdef  (NEU)
└── Presets/
    └── (leer, wird in 28.3 befüllt)
```

---

## Nächster Schritt

→ [28.3 BDO + ArcheAge Presets](28.3-bdo-archage-presets.md)
