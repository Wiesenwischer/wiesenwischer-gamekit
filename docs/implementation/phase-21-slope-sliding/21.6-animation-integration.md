# 21.6 CharacterAnimationState.Slide + Animator

> **Commit:** `feat(phase-21): 21.6 Slide Animation-Integration`
> **Branch:** `feat/slide-animation-integration`

---

## Ziel

Neuen `Slide` Wert in der `CharacterAnimationState` Enum, Animator Controller State und CrossFade-Konfiguration ergänzen.

---

## Anweisungen

### 1. CharacterAnimationState erweitern

**Datei:** `Packages/.../Core/Animation/IAnimationController.cs`

Neuen Enum-Wert hinzufügen:

```csharp
public enum CharacterAnimationState
{
    Locomotion,
    Jump,
    Fall,
    SoftLand,
    HardLand,
    LightStop,
    MediumStop,
    HardStop,
    Slide        // ← NEU
}
```

### 2. AnimationParameters erweitern

**Datei:** `Packages/.../Animation/Runtime/Core/AnimationParameters.cs`

Neuen State-Hash hinzufügen:

```csharp
// State Hashes
public static readonly int SlideHash = Animator.StringToHash("Slide");
```

Und im Mapping (falls eine Map-Methode existiert):
```csharp
case CharacterAnimationState.Slide: return SlideHash;
```

### 3. AnimatorAnimationController erweitern

**Datei:** `Packages/.../Animation/Runtime/Core/AnimatorAnimationController.cs`

Im `PlayState()` Switch-Case:
```csharp
case CharacterAnimationState.Slide:
    _animator.CrossFadeInFixedTime(AnimationParameters.SlideHash, transitionDuration, 0);
    break;
```

### 4. AnimationTransitionConfig erweitern

**Datei:** `Packages/.../Animation/Runtime/Core/AnimationTransitionConfig.cs`

Neues Feld:
```csharp
[Header("Slope Sliding")]
[Tooltip("CrossFade-Dauer beim Wechsel zu Slide")]
[SerializeField] private float _slideTransitionDuration = 0.2f;

public float SlideTransitionDuration => _slideTransitionDuration;
```

Im `GetTransitionDuration()` Switch:
```csharp
case CharacterAnimationState.Slide: return _slideTransitionDuration;
```

Im `OnValidate()`:
```csharp
_slideTransitionDuration = Mathf.Max(0f, _slideTransitionDuration);
```

### 5. Animator Controller: Neuen State erstellen

**Datei:** `Packages/.../Animation/Resources/AnimatorControllers/CharacterAnimatorController.controller`

Im Unity Editor (manuell oder via Code):

1. **Neuen State "Slide"** in der Base Layer State Machine erstellen
2. **Motion:** `Anim_Slide` Animation Clip zuweisen
3. **Transitions:**
   - **Any State → Slide:** Kein Exit Time, Condition = wird via CrossFadeInFixedTime gesteuert
   - (Kein manueller Transition nötig — `CrossFadeInFixedTime` macht das automatisch)

> **Hinweis:** Da das bestehende System `CrossFadeInFixedTime` mit State-Hashes verwendet, braucht der Animator-State nur den korrekten Namen "Slide" — Transitions werden programmatisch gesteuert.

### 6. Kompilierung prüfen

```bash
powershell -Command "Get-Content 'C:\Users\marcu\AppData\Local\Unity\Editor\Editor.log' -Tail 100 | Select-String -Pattern 'error|CS\d{4}'"
```

---

## Verifikation

- [ ] `CharacterAnimationState.Slide` existiert im Enum
- [ ] `AnimationParameters.SlideHash` ist korrekt initialisiert
- [ ] `PlayState(CharacterAnimationState.Slide)` löst CrossFade aus
- [ ] `GetTransitionDuration(Slide)` gibt 0.2f zurück (Default)
- [ ] Animator Controller hat "Slide" State mit korrekter Animation
- [ ] Im Play Mode: Slide-Animation wird bei Sliding-State korrekt abgespielt
- [ ] Projekt kompiliert fehlerfrei

---

## Erwartete Änderungen

```
M  Packages/.../Core/Animation/IAnimationController.cs                (+Slide Enum)
M  Packages/.../Animation/Runtime/Core/AnimationParameters.cs          (+SlideHash)
M  Packages/.../Animation/Runtime/Core/AnimatorAnimationController.cs  (+Slide Case)
M  Packages/.../Animation/Runtime/Core/AnimationTransitionConfig.cs    (+Slide Duration)
M  Packages/.../Animation/Resources/.../CharacterAnimatorController.controller  (+Slide State)
```

---

**Nächster Schritt:** [21.7 Unit Tests](21.7-unit-tests.md)
