# BDO-Style Combat -- Animation Blending Strategies for MMO Networking

This document explains how animation blending should be structured when
building networked action combat systems (BDO-style) to avoid desync,
visual mismatch, and prediction problems.

Goal:

-   Smooth animation transitions
-   Deterministic gameplay state
-   Network-safe visual layers
-   Minimal corrections during reconciliation

This assumes the previously defined architecture:

CombatController → ActionGraph → PhaseAuthority → MotionAuthority →
CharacterMotor → Animator (visual only)

------------------------------------------------------------------------

# 1. Core Principle

Gameplay state MUST NOT depend on animation blending.

Correct:

Combat logic drives animation.

Incorrect:

Animation transitions drive gameplay decisions.

Animator is a visual output layer only.

------------------------------------------------------------------------

# 2. Separation of Layers

Recommended animation layering:

Layer 1 --- Locomotion Base - Idle - Walk - Run - Turn

Layer 2 --- Combat Actions - Attack animations - Dodge - Block - Skills

Layer 3 --- Additive Overlays - upper body adjustments - recoil - hit
reactions

Layer 4 --- Procedural Adjustments - aim offset - look direction - IK
corrections

------------------------------------------------------------------------

# 3. Network-Safe Animation States

Animator should reflect:

-   current action node
-   current phase
-   movement state

Server does NOT need full animation data.

Server only needs:

-   action ID
-   phase index
-   direction vector (optional)

Client reconstructs visuals locally.

------------------------------------------------------------------------

# 4. Blend Trees for Networked Locomotion

Use blend trees for movement animations:

Input parameters:

-   velocity magnitude
-   movement direction (camera-relative)
-   grounded state

Benefits:

-   smoother transitions
-   fewer network updates required.

------------------------------------------------------------------------

# 5. Phase-Based Animation Synchronization

Combat phases control animation timing.

Example:

Startup phase: - play windup animation.

Active phase: - ensure animation aligns with hit window.

Recovery phase: - transition into recovery blend.

Important:

Animation time should be driven by phase progression.

------------------------------------------------------------------------

# 6. Handling Network Corrections

When server correction occurs:

Avoid:

-   snapping animation to new state.

Instead:

-   smoothly crossfade to corrected animation.
-   maintain animation continuity when possible.

------------------------------------------------------------------------

# 7. Animation Events vs Networking

Avoid using animation events as authoritative triggers.

Use animation events only for:

-   VFX
-   Audio

Gameplay triggers:

-   driven by PhaseAuthority instead.

------------------------------------------------------------------------

# 8. Root Motion Considerations

Recommended for MMO:

-   Disable root motion authority.
-   Extract motion intent if needed.
-   Motor applies deterministic movement.

Root motion directly causes:

-   desync
-   inconsistent prediction.

------------------------------------------------------------------------

# 9. Additive Animation Layers (AAA Strategy)

Additive layers help preserve network stability:

Examples:

-   weapon recoil
-   small flinch reactions
-   upper body aim offsets.

Additive layers allow corrections without large animation resets.

------------------------------------------------------------------------

# 10. Rotation Blending

Avoid hard rotation snaps.

Use:

-   gradual rotation interpolation
-   rotation assist driven by combat logic.

------------------------------------------------------------------------

# 11. Animation State Replication Strategy

Server sends minimal data:

-   action node ID
-   phase state
-   timestamp

Client:

-   reconstructs animation blend locally.

------------------------------------------------------------------------

# 12. Common Networking Animation Mistakes

❌ Animator-driven gameplay timing.

❌ Replicating full animation state over network.

❌ Root motion authority.

❌ Hard lock-on animations.

------------------------------------------------------------------------

# 13. Recommended Architecture Flow

INPUT ↓ CombatController (deterministic) ↓ PhaseAuthority ↓
MotionAuthority ↓ CharacterMotor ↓ Animator (Blend Trees + Layers) ↓
Impact/VFX/Audio

------------------------------------------------------------------------

# Possible Next Topics

-   Enemy animation networking
-   Hit reaction blending strategies
-   Predictive animation smoothing
